<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Score Display & American Literature</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
      background-color: white;
      font-family: Arial, sans-serif;
      color: white;
    }

    #skorDisplay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 80vh;
      font-weight: bold;
      visibility: hidden;
      line-height: 1;
      text-align: center;
      white-space: nowrap;
      z-index: 2;
      -webkit-text-stroke: 4px orange;
    }

    #starter {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      z-index: 9999;
      cursor: pointer;
    }

    #ornamenContainer, #glowLayer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
    }

    .shake {
      animation: shake 0.6s ease-in-out;
    }

    @keyframes shake {
      0% { transform: translate(0, 0); }
      20% { transform: translate(-5px, 0); }
      40% { transform: translate(5px, 0); }
      60% { transform: translate(-5px, 0); }
      80% { transform: translate(5px, 0); }
      100% { transform: translate(0, 0); }
    }

    @keyframes glowBurst {
      0% {
        opacity: 0.8;
        transform: scale(0.5);
        filter: blur(20px);
        background: radial-gradient(circle at center, red, orange, yellow, green, cyan, blue, violet);
      }
      100% {
        opacity: 0;
        transform: scale(2);
        filter: blur(60px);
      }
    }

    #layoutWrapper {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      padding: 40px;
      box-sizing: border-box;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      z-index: 5;
      gap: 40px;
    }

    #leftColumn {
      width: 40%;
      max-width: 600px;
      background-color: #f8f9fa;
      color: #212529;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      font-size: 0.95em;
    }

    #rightColumn {
      width: 55%;
      height: 100%;
      padding: 10px;
    }

    #categoryContainer {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 24px;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
    }

    .category {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 2em;
      font-weight: bold;
      padding: 24px;
      border-radius: 16px;
      color: #fff;
      height: 100%;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      word-wrap: break-word;
    }
  </style>
</head>
<body>

  <div id="skorDisplay"></div>
  <div id="starter" onclick="unlockAudio()">Start</div>
  <div id="ornamenContainer"></div>
  <div id="glowLayer"></div>

  <div id="layoutWrapper">
    <div id="leftColumn">
      <div id="instructions">
        <h4 class="mb-3">Instructions</h4>
        <ol class="fs-6">
          <li>Once you click the <strong>Randomize</strong> button, 9 categories will appear on the screen.</li>
          <li>The button may be used up to five times. Each participant is allowed to click it once.</li>
          <li>You may select one category and will be asked up to three questions based on your choice.</li>
          <li>If you feel your responses are not quite satisfying, you may select one additional category â€” without clicking the button again.</li>
        </ol>
      </div>
      <button id="shuffleBtn" class="btn btn-primary mt-4">Randomize Category</button>
    </div>

    <div id="rightColumn">
      <div id="categoryContainer"></div>
    </div>
  </div>

  <audio id="niceTry" src="https://yogaptek.github.io/suara/drum-roll-and-cymbals.mp3" preload="auto"></audio>
  <audio id="notBad" src="https://assets.mixkit.co/sfx/download/mixkit-game-notification-wave-2314.mp3" preload="auto"></audio>
  <audio id="goodJob" src="https://assets.mixkit.co/sfx/download/mixkit-achievement-bell-600.mp3" preload="auto"></audio>
  <audio id="applause" src="https://assets.mixkit.co/sfx/download/mixkit-small-crowd-applause-503.mp3" preload="auto"></audio>

  <script>
    const starter = document.getElementById("starter");
    const layoutWrapper = document.getElementById("layoutWrapper");
    const skorDisplay = document.getElementById("skorDisplay");
    const glowLayer = document.getElementById("glowLayer");
    const shuffleBtn = document.getElementById("shuffleBtn");
    const container = document.getElementById("categoryContainer");

    const sounds = {
      niceTry: document.getElementById("niceTry"),
      notBad: document.getElementById("notBad"),
      goodJob: document.getElementById("goodJob"),
      applause: document.getElementById("applause")
    };

    let audioUnlocked = false;
    let clickCount = 0;
    const maxClicks = 5;

    function unlockAudio() {
      starter.style.display = "none";
      layoutWrapper.style.display = "flex";
      Object.values(sounds).forEach(audio => {
        audio.play().catch(() => {});
        audio.pause();
        audio.currentTime = 0;
      });
      audioUnlocked = true;
    }

    function playFeedbackSound(score) {
      if (!audioUnlocked) return;
      Object.values(sounds).forEach(audio => {
        audio.pause();
        audio.currentTime = 0;
      });
      if (score < 50) sounds.niceTry.play();
      else if (score < 70) sounds.notBad.play();
      else if (score < 90) sounds.goodJob.play();
      else sounds.applause.play();
    }

    function tampilkanGlow() {
      glowLayer.style.animation = "none";
      void glowLayer.offsetWidth;
      glowLayer.style.animation = "glowBurst 1s ease-out forwards";
    }

    // Simulasi skor (bisa diganti dengan Firebase listener)
    function triggerSkor(label, score) {
  skorDisplay.textContent = label;
  skorDisplay.style.visibility = "visible";
  skorDisplay.classList.remove("shake");
  void skorDisplay.offsetWidth;
  skorDisplay.classList.add("shake");
  playFeedbackSound(score);
  tampilkanGlow();
  setTimeout(() => {
    skorDisplay.style.visibility = "hidden";
    skorDisplay.textContent = "";
  }, 3000);
}
    firebase.database().ref('trigger').on('value', function(snapshot) {
  const val = snapshot.val();
  if (val && typeof val === 'object' && val.label && val.skor !== undefined) {
    triggerSkor(val.label, parseInt(val.skor));
    firebase.database().ref('trigger').set('idle');
  }
});
    const americanCategories = [
      "Native American Literature", "Realism", "Modernism", "Naturalism", "Romanticism",
      "Declaration of Independence", "Savages", "Transcendentalism", "Slave Narrative", "Colonial Period",
      "Puritanism", "John Smith", "John Winthrop", "Olaudah Equiano", "Melting Pot and Salad Bowl",    "Self Reliance", "The Cask of Amontillado", "Writing Style", "Local Color", "The Black Minister's Veil",
    "Afro American Voices in Modern Era", "Enlightenment", "What We Talk About When We Talk about Love",
    "Richard Wright", "Langston Hughes", "American Literature in General", "American Authors",
    "Present your Intellectual Diary in 3 minutes", "Random Question with 80pts", "Ask a question 30pts"
  ];

  const colors = [
    "#e74c3c", "#3498db", "#2ecc71", "#9b59b6", "#f39c12",
    "#1abc9c", "#e67e22", "#34495e", "#d35400", "#7f8c8d",
    "#16a085", "#c0392b", "#2980b9", "#8e44ad", "#27ae60"
  ];

  function shuffleAndDisplay() {
    container.innerHTML = "";
    const shuffled = americanCategories.sort(() => 0.5 - Math.random()).slice(0, 9);
    shuffled.forEach((cat, index) => {
      const div = document.createElement("div");
      div.className = "category";
      div.textContent = cat;
      div.style.backgroundColor = colors[index % colors.length];
      container.appendChild(div);
    });

    clickCount++;
    if (clickCount >= maxClicks) {
      shuffleBtn.disabled = true;
    }
  }

  shuffleBtn.addEventListener("click", shuffleAndDisplay);
</script>
</body>
</html>
