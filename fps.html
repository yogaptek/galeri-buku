<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>A-Frame JSON Loader</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
</head>
<body>
  <a-scene physics="gravity: -9.8">
    <a-sky color="#88c9ff"></a-sky>
    <a-plane rotation="-90 0 0" width="1000" height="1000" color="#9E9E9E" static-body></a-plane>

    <!-- Kamera FPS -->
    <a-entity camera wasd-controls look-controls="pointerLockEnabled: true"
              position="0 1.6 50"
              dynamic-body="shape: sphere; sphereRadius: 0.35; mass: 5">
    </a-entity>
  </a-scene>

  <script>
    // Contoh JSON (bisa di-load dari file eksternal)
    const data = {
      "levels": [
        {
          "objects": [
            { "type": "wall", "xStart": 0, "yStart": 0, "xEnd": 500, "yEnd": 0, "height": 250, "thickness": 20 },
            { "type": "wall", "xStart": 500, "yStart": 0, "xEnd": 500, "yEnd": 400, "height": 250, "thickness": 20 },
            { "type": "furniture", "name": "Table", "x": 200, "y": 150, "width": 120, "depth": 80, "height": 75 }
          ]
        }
      ]
    };

    const scene = document.querySelector('a-scene');

    data.levels[0].objects.forEach(obj => {
      if (obj.type === "wall") {
        const wall = document.createElement("a-box");
        const midX = (obj.xStart + obj.xEnd) / 2;
        const midZ = (obj.yStart + obj.yEnd) / 2;
        const length = Math.hypot(obj.xEnd - obj.xStart, obj.yEnd - obj.yStart);
        const angle = Math.atan2(obj.yEnd - obj.yStart, obj.xEnd - obj.xStart) * 180 / Math.PI;

        wall.setAttribute("position", `${midX} ${obj.height/2} ${midZ}`);
        wall.setAttribute("width", length);
        wall.setAttribute("height", obj.height);
        wall.setAttribute("depth", obj.thickness);
        wall.setAttribute("rotation", `0 ${-angle} 0`);
        wall.setAttribute("color", "#808080");
        wall.setAttribute("static-body", "");
        scene.appendChild(wall);
      }

      if (obj.type === "furniture") {
        const furn = document.createElement("a-box");
        furn.setAttribute("position", `${obj.x} ${obj.height/2} ${obj.y}`);
        furn.setAttribute("width", obj.width);
        furn.setAttribute("height", obj.height);
        furn.setAttribute("depth", obj.depth);
        furn.setAttribute("color", "#a0522d");
        furn.setAttribute("static-body", "");
        scene.appendChild(furn);
      }
    });
  </script>
</body>
</html>
